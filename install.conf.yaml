- defaults:
    link:
      create: true
      force: true
    shell:
      stdin: true

# Install Homebrew if not installed
- install-brew: true

# Tap Homebrew taps
# NOTE: Due to a bug in the `dotbot-brew` plugin, the `tap` directive is
# not working as expected. As a workaround, we tap with a `shell`
# directive.
- shell:
  - # Tap `homebrew/cask-fonts`
    command: brew tap homebrew/cask-fonts
    description: Tapping `homebrew/cask-fonts`

# Install Homebrew packages
- brew:
  - fish
  - starship
  - gpg
  - git
  - git-delta
  - pyenv
  - juliaup
  - typst

# Install Homebrew casks
- cask:
  - mactex
  - alacritty
  - font-fira-code-nerd-font

# Post-installation steps
- shell:
  - # Setup Python (with pyenv)
    command: source ./pyenv/setup_python.sh
    description: Setting up Python with pyenv
  - # Setup Julia (with juliaup)
    command: source ./juliaup/setup_julia.sh
    description: Setting up Julia with juliaup
  - # Use fish as default shell
    command: chsh -s $(which fish)
    description: Making fish the default shell

# Clear broken symlinks
- clean: [ '~' ]
- clean:
    ~/.config:
      recursive: true

# Symlink dotfiles
- link:
    # Fish
    ~/.config/fish/config.fish: fish/config.fish
    ~/.config/fish/functions: fish/functions
    ~/.config/fish/conf.d: fish/conf.d
    # Starship
    ~/.config/starship.toml: starship/starship.toml
    # Git
    ~/.gitconfig: git/.gitconfig
    ~/.gitconfig.local: git/.gitconfig.local
    ~/.gitignore_global: git/.gitignore_global
    # Alacritty
    ~/.config/alacritty/alacritty.toml: alacritty/alacritty.toml
    ~/.config/alacritty/themes: alacritty/themes
